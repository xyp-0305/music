{"version":3,"file":"index.js","sources":["../../src/index.js"],"sourcesContent":["/**\n * simple facade for runtime and compiler\n */\n\nimport XTemplateRuntime from 'xtemplate-runtime';\nimport XTemplateCompiler from 'xtemplate-compiler';\n\nconst { util } = XTemplateRuntime;\nconst { compile } = XTemplateCompiler;\n\n/**\n * xtemplate engine\n *\n *      @example\n *      modulex.use('xtemplate', function(XTemplate){\n *          document.writeln(new XTemplate('{{title}}').render({title:2}));\n *      });\n *\n * @class XTemplate\n * @extends XTemplate.Runtime\n */\nfunction XTemplate(tpl_, config_) {\n  let tpl = tpl_;\n  let config = config_;\n  const tplType = typeof tpl;\n  if (tplType !== 'string' && tplType !== 'function') {\n    config = tpl;\n    tpl = undefined;\n  }\n  config = this.config = util.merge(XTemplate.globalConfig, config);\n  if (tplType === 'string') {\n    try {\n      tpl = this.compile(tpl, config.name);\n    } catch (err) {\n      this.compileError = err;\n    }\n  }\n  XTemplateRuntime.call(this, tpl, config);\n}\n\nfunction Noop() {}\n\nNoop.prototype = XTemplateRuntime.prototype;\nXTemplate.prototype = new Noop();\nXTemplate.prototype.constructor = XTemplate;\n\nutil.mix(XTemplate.prototype, {\n  compile(content, name) {\n    return compile(content, name, this.config);\n  },\n\n  render(data, option, callback_) {\n    let callback = callback_;\n    if (typeof option === 'function') {\n      callback = option;\n    }\n    const compileError = this.compileError;\n    if (compileError) {\n      if (callback) {\n        callback(compileError);\n      } else {\n        throw compileError;\n      }\n    } else {\n      return XTemplateRuntime.prototype.render.apply(this, arguments);\n    }\n  },\n});\n\nexport default util.mix(XTemplate, {\n  globalConfig: {},\n\n  config: XTemplateRuntime.config,\n\n  compile,\n\n  Compiler: XTemplateCompiler,\n\n  Scope: XTemplateRuntime.Scope,\n\n  Runtime: XTemplateRuntime,\n\n  /**\n   * add command to all template\n   * @method\n   * @static\n   * @param {String} commandName\n   * @param {Function} fn\n   */\n  addCommand: XTemplateRuntime.addCommand,\n\n  /**\n   * remove command from all template by name\n   * @method\n   * @static\n   * @param {String} commandName\n   */\n  removeCommand: XTemplateRuntime.removeCommand,\n});\n\n/*\n It consists three modules:\n\n -   xtemplate - Both compiler and runtime functionality.\n -   xtemplate/compiler - Compiler string template to module functions.\n -   xtemplate/runtime -  Runtime for string template( with xtemplate/compiler loaded)\n or template functions.\n\n xtemplate/compiler depends on xtemplate/runtime,\n because compiler needs to know about runtime to generate corresponding codes.\n */\n"],"names":["util","XTemplateRuntime","compile","XTemplateCompiler","XTemplate","tpl_","config_","tpl","config","tplType","undefined","merge","globalConfig","name","err","compileError","call","Noop","prototype","constructor","mix","content","render","data","option","callback_","callback","apply","arguments","Compiler","Scope","Runtime","addCommand","removeCommand"],"mappings":";;;AAAA;;;AAIA,IAGQA,OAASC,iBAATD;IACAE,WAAYC,kBAAZD;;;;;;;;;;;;;AAaR,SAASE,SAAT,CAAmBC,IAAnB,EAAyBC,OAAzB,EAAkC;MAC5BC,GAAG,GAAGF,IAAV;MACIG,MAAM,GAAGF,OAAb;MACMG,OAAO,GAAG,OAAOF,GAAvB;;MACIE,OAAO,KAAK,QAAZ,IAAwBA,OAAO,KAAK,UAAxC,EAAoD;IAClDD,MAAM,GAAGD,GAAT;IACAA,GAAG,GAAGG,SAAN;;;EAEFF,MAAM,GAAG,KAAKA,MAAL,GAAcR,IAAI,CAACW,KAAL,CAAWP,SAAS,CAACQ,YAArB,EAAmCJ,MAAnC,CAAvB;;MACIC,OAAO,KAAK,QAAhB,EAA0B;QACpB;MACFF,GAAG,GAAG,KAAKL,OAAL,CAAaK,GAAb,EAAkBC,MAAM,CAACK,IAAzB,CAAN;KADF,CAEE,OAAOC,GAAP,EAAY;WACPC,YAAL,GAAoBD,GAApB;;;;EAGJb,gBAAgB,CAACe,IAAjB,CAAsB,IAAtB,EAA4BT,GAA5B,EAAiCC,MAAjC;;;AAGF,SAASS,IAAT,GAAgB;;AAEhBA,IAAI,CAACC,SAAL,GAAiBjB,gBAAgB,CAACiB,SAAlC;AACAd,SAAS,CAACc,SAAV,GAAsB,IAAID,IAAJ,EAAtB;AACAb,SAAS,CAACc,SAAV,CAAoBC,WAApB,GAAkCf,SAAlC;AAEAJ,IAAI,CAACoB,GAAL,CAAShB,SAAS,CAACc,SAAnB,EAA8B;EAC5BhB,OAD4B,mBACpBmB,OADoB,EACXR,IADW,EACL;WACdX,QAAO,CAACmB,OAAD,EAAUR,IAAV,EAAgB,KAAKL,MAArB,CAAd;GAF0B;EAK5Bc,MAL4B,kBAKrBC,IALqB,EAKfC,MALe,EAKPC,SALO,EAKI;QAC1BC,QAAQ,GAAGD,SAAf;;QACI,OAAOD,MAAP,KAAkB,UAAtB,EAAkC;MAChCE,QAAQ,GAAGF,MAAX;;;QAEIT,YAAY,GAAG,KAAKA,YAA1B;;QACIA,YAAJ,EAAkB;UACZW,QAAJ,EAAc;QACZA,QAAQ,CAACX,YAAD,CAAR;OADF,MAEO;cACCA,YAAN;;KAJJ,MAMO;aACEd,gBAAgB,CAACiB,SAAjB,CAA2BI,MAA3B,CAAkCK,KAAlC,CAAwC,IAAxC,EAA8CC,SAA9C,CAAP;;;CAlBN;AAuBA,YAAe5B,IAAI,CAACoB,GAAL,CAAShB,SAAT,EAAoB;EACjCQ,YAAY,EAAE,EADmB;EAGjCJ,MAAM,EAAEP,gBAAgB,CAACO,MAHQ;EAKjCN,OAAO,EAAPA,QALiC;EAOjC2B,QAAQ,EAAE1B,iBAPuB;EASjC2B,KAAK,EAAE7B,gBAAgB,CAAC6B,KATS;EAWjCC,OAAO,EAAE9B,gBAXwB;;;;;;;;;EAoBjC+B,UAAU,EAAE/B,gBAAgB,CAAC+B,UApBI;;;;;;;;EA4BjCC,aAAa,EAAEhC,gBAAgB,CAACgC;CA5BnB,CAAf;;;;;;;;;;;;;;;"}